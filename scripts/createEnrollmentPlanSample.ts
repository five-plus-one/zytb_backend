import * as XLSX from 'xlsx';
import * as path from 'path';
import * as fs from 'fs';

// 示例招生计划数据
const sampleData = [
  {
    '年份': 2024,
    '生源地': '浙江省',
    '科类': '物理类',
    '批次': '本科一批',
    '院校代码': '10001',
    '院校名称': '北京大学',
    '院校专业组代码': 'PKU01',
    '专业组代码': '001',
    '专业组名称': '计算机类',
    '选科要求': '物理+化学',
    '专业代码': '080901',
    '专业名称': '计算机科学与技术',
    '专业备注': '国家重点学科',
    '计划人数': 50,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2024,
    '生源地': '浙江省',
    '科类': '物理类',
    '批次': '本科一批',
    '院校代码': '10001',
    '院校名称': '北京大学',
    '院校专业组代码': 'PKU01',
    '专业组代码': '001',
    '专业组名称': '计算机类',
    '选科要求': '物理+化学',
    '专业代码': '080902',
    '专业名称': '软件工程',
    '专业备注': '',
    '计划人数': 45,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2024,
    '生源地': '浙江省',
    '科类': '物理类',
    '批次': '本科一批',
    '院校代码': '10002',
    '院校名称': '清华大学',
    '院校专业组代码': 'THU01',
    '专业组代码': '001',
    '专业组名称': '理工类',
    '选科要求': '物理',
    '专业代码': '080901',
    '专业名称': '计算机科学与技术',
    '专业备注': '',
    '计划人数': 48,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2024,
    '生源地': '浙江省',
    '科类': '历史类',
    '批次': '本科一批',
    '院校代码': '10001',
    '院校名称': '北京大学',
    '院校专业组代码': 'PKU02',
    '专业组代码': '002',
    '专业组名称': '人文社科类',
    '选科要求': '不限',
    '专业代码': '030101',
    '专业名称': '法学',
    '专业备注': '国家一流专业',
    '计划人数': 30,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2024,
    '生源地': '浙江省',
    '科类': '历史类',
    '批次': '本科一批',
    '院校代码': '10002',
    '院校名称': '清华大学',
    '院校专业组代码': 'THU02',
    '专业组代码': '002',
    '专业组名称': '文科类',
    '选科要求': '不限',
    '专业代码': '050101',
    '专业名称': '中国语言文学类',
    '专业备注': '',
    '计划人数': 25,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2024,
    '生源地': '江苏省',
    '科类': '物理类',
    '批次': '本科一批',
    '院校代码': '10001',
    '院校名称': '北京大学',
    '院校专业组代码': 'PKU01',
    '专业组代码': '001',
    '专业组名称': '计算机类',
    '选科要求': '物理+化学',
    '专业代码': '080901',
    '专业名称': '计算机科学与技术',
    '专业备注': '',
    '计划人数': 40,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2023,
    '生源地': '浙江省',
    '科类': '物理类',
    '批次': '本科一批',
    '院校代码': '10001',
    '院校名称': '北京大学',
    '院校专业组代码': 'PKU01',
    '专业组代码': '001',
    '专业组名称': '计算机类',
    '选科要求': '物理+化学',
    '专业代码': '080901',
    '专业名称': '计算机科学与技术',
    '专业备注': '',
    '计划人数': 48,
    '学制': 4,
    '学费': 5000
  },
  {
    '年份': 2023,
    '生源地': '浙江省',
    '科类': '物理类',
    '批次': '本科一批',
    '院校代码': '10002',
    '院校名称': '清华大学',
    '院校专业组代码': 'THU01',
    '专业组代码': '001',
    '专业组名称': '理工类',
    '选科要求': '物理',
    '专业代码': '080901',
    '专业名称': '计算机科学与技术',
    '专业备注': '',
    '计划人数': 46,
    '学制': 4,
    '学费': 5000
  }
];

// 创建工作簿
const workbook = XLSX.utils.book_new();

// 将数据转换为工作表
const worksheet = XLSX.utils.json_to_sheet(sampleData);

// 设置列宽
const columnWidths = [
  { wch: 8 },  // 年份
  { wch: 12 }, // 生源地
  { wch: 10 }, // 科类
  { wch: 12 }, // 批次
  { wch: 12 }, // 院校代码
  { wch: 15 }, // 院校名称
  { wch: 18 }, // 院校专业组代码
  { wch: 15 }, // 专业组代码
  { wch: 15 }, // 专业组名称
  { wch: 15 }, // 选科要求
  { wch: 12 }, // 专业代码
  { wch: 25 }, // 专业名称
  { wch: 20 }, // 专业备注
  { wch: 12 }, // 计划人数
  { wch: 8 },  // 学制
  { wch: 10 }  // 学费
];

worksheet['!cols'] = columnWidths;

// 添加工作表到工作簿
XLSX.utils.book_append_sheet(workbook, worksheet, '招生计划');

// 确保输出目录存在
const outputDir = path.resolve(__dirname, '../data');
if (!fs.existsSync(outputDir)) {
  fs.mkdirSync(outputDir, { recursive: true });
}

// 写入文件
const outputPath = path.join(outputDir, 'enrollment_plans_sample.xlsx');
XLSX.writeFile(workbook, outputPath);

console.log('✅ 示例Excel文件创建成功!');
console.log(`📁 文件位置: ${outputPath}`);
console.log(`📊 数据行数: ${sampleData.length}`);
console.log('\n可以使用以下命令导入:');
console.log(`npm run import-enrollment-plans ${outputPath}`);
