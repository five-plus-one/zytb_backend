import * as XLSX from 'xlsx';
import * as path from 'path';

// 创建示例专业数据
const sampleData = [
  {
    '专业代码': '080901',
    '专业名称': '计算机科学与技术',
    '学科': '工学',
    '门类': '计算机类',
    '子类': '',
    '匹配学科': '物理,数学',
    '学位': '工学学士',
    '学位类型': '工学',
    '学制': 4,
    '培养对象': '本专业培养具有良好科学素养,系统掌握计算机科学与技术基础理论、基本知识和基本技能,能在科研部门、教育单位、企事业和行政管理部门等单位从事计算机教学、科学研究和应用的计算机科学与技术学科的高级专门人才。',
    '主修课程': '程序设计基础,数据结构,计算机组成原理,操作系统,计算机网络,数据库系统,软件工程,人工智能',
    '是否热门': '是',
    '标签': 'IT行业,高薪,技术密集',
    '平均薪资': 12000,
    '就业率': 95.5,
    '职业方向': '可从事软件开发工程师、系统架构师、算法工程师、数据工程师、网络工程师等工作。就业方向包括互联网企业、科技公司、金融机构、政府机关等。',
    '职业领域': '软件开发,人工智能,大数据,云计算,网络安全',
    '技能要求': '编程能力,算法设计,系统分析,问题解决,团队协作',
    '优势院校': '清华大学,北京大学,浙江大学,国防科技大学,北京航空航天大学'
  },
  {
    '专业代码': '100201',
    '专业名称': '临床医学',
    '学科': '医学',
    '门类': '临床医学类',
    '子类': '',
    '匹配学科': '化学,生物',
    '学位': '医学学士',
    '学位类型': '医学',
    '学制': 5,
    '培养对象': '本专业培养具备基础医学、临床医学的基本理论和医疗预防的基本技能,能在医疗卫生单位、医学科研等部门从事医疗及预防、医学科研等方面工作的医学高级专门人才。',
    '主修课程': '人体解剖学,生理学,病理学,药理学,诊断学,内科学,外科学,妇产科学,儿科学',
    '是否热门': '是',
    '标签': '医疗健康,稳定,社会需求大',
    '平均薪资': 10000,
    '就业率': 92.8,
    '职业方向': '可从事临床医师、外科医生、内科医生、妇产科医生、儿科医生等工作。就业方向包括各级医院、社区卫生服务中心、医学院校、医学研究机构等。',
    '职业领域': '临床诊疗,医学研究,公共卫生,医学教育',
    '技能要求': '医学知识,诊断能力,沟通能力,责任心,持续学习',
    '优势院校': '北京协和医学院,上海交通大学医学院,复旦大学上海医学院,浙江大学医学院,四川大学华西医学中心'
  },
  {
    '专业代码': '050101',
    '专业名称': '汉语言文学',
    '学科': '文学',
    '门类': '中国语言文学类',
    '子类': '',
    '匹配学科': '语文,历史',
    '学位': '文学学士',
    '学位类型': '文学',
    '学制': 4,
    '培养对象': '本专业培养具备较强的文字表达能力和一定的文艺理论素养,能在新闻文艺出版部门、高校、科研机构和机关企事业单位从事文学评论、汉语言文学教学与研究工作,以及文化、宣传方面的实际工作的汉语言文学专门人才。',
    '主修课程': '语言学概论,古代汉语,现代汉语,文学概论,中国古代文学,中国现代文学,中国当代文学,外国文学,写作',
    '是否热门': '否',
    '标签': '人文素养,文化传承,表达能力',
    '平均薪资': 6500,
    '就业率': 85.2,
    '职业方向': '可从事教师、编辑、记者、文案策划、文秘、公务员等工作。就业方向包括教育机构、新闻出版、文化传媒、政府机关、企事业单位等。',
    '职业领域': '教育,出版,新闻传媒,文化艺术,行政管理',
    '技能要求': '文字功底,阅读理解,写作能力,文化素养,沟通表达',
    '优势院校': '北京大学,北京师范大学,复旦大学,南京大学,武汉大学'
  },
  {
    '专业代码': '020301',
    '专业名称': '金融学',
    '学科': '经济学',
    '门类': '金融学类',
    '子类': '',
    '匹配学科': '数学,政治',
    '学位': '经济学学士',
    '学位类型': '经济学',
    '学制': 4,
    '培养对象': '本专业培养具有金融学理论知识及专业技能,能在银行、证券、投资、保险及其他经济管理部门和企业从事相关工作的专门人才。',
    '主修课程': '微观经济学,宏观经济学,会计学,统计学,计量经济学,货币银行学,国际金融,证券投资学,公司金融,金融工程',
    '是否热门': '是',
    '标签': '金融行业,高收入,数据分析',
    '平均薪资': 11000,
    '就业率': 90.3,
    '职业方向': '可从事投资分析师、金融产品经理、理财顾问、风险管理专员、证券分析师等工作。就业方向包括银行、证券公司、保险公司、基金公司、投资公司等。',
    '职业领域': '银行业,证券投资,保险,基金管理,风险管理',
    '技能要求': '数据分析,金融建模,风险评估,市场洞察,沟通能力',
    '优势院校': '中国人民大学,清华大学,北京大学,复旦大学,上海财经大学'
  },
  {
    '专业代码': '082502',
    '专业名称': '环境工程',
    '学科': '工学',
    '门类': '环境科学与工程类',
    '子类': '',
    '匹配学科': '化学,物理,生物',
    '学位': '工学学士',
    '学位类型': '工学',
    '学制': 4,
    '培养对象': '本专业培养具备城市和城镇水、气、声、固体废物等污染防治和给排水工程、污染控制规划和水资源保护等方面知识的环境工程学科高级工程技术人才。',
    '主修课程': '环境工程原理,环境监测,水污染控制工程,大气污染控制工程,固体废物处理与处置,环境影响评价,环境规划与管理',
    '是否热门': '否',
    '标签': '环保,绿色产业,可持续发展',
    '平均薪资': 7500,
    '就业率': 87.6,
    '职业方向': '可从事环境工程师、环评工程师、水处理工程师、环境监测员、环保顾问等工作。就业方向包括环保企业、市政工程公司、环境监测站、设计院等。',
    '职业领域': '环境保护,污染治理,环境监测,环境规划,环保咨询',
    '技能要求': '环境科学知识,工程设计,数据分析,环保法规,项目管理',
    '优势院校': '清华大学,哈尔滨工业大学,同济大学,北京大学,南京大学'
  }
];

// 创建工作簿
const workbook = XLSX.utils.book_new();

// 将数据转换为工作表
const worksheet = XLSX.utils.json_to_sheet(sampleData);

// 设置列宽
worksheet['!cols'] = [
  { wch: 12 }, // 专业代码
  { wch: 25 }, // 专业名称
  { wch: 10 }, // 学科
  { wch: 20 }, // 门类
  { wch: 15 }, // 子类
  { wch: 20 }, // 匹配学科
  { wch: 12 }, // 学位
  { wch: 10 }, // 学位类型
  { wch: 8 },  // 学制
  { wch: 80 }, // 培养对象
  { wch: 80 }, // 主修课程
  { wch: 10 }, // 是否热门
  { wch: 30 }, // 标签
  { wch: 12 }, // 平均薪资
  { wch: 10 }, // 就业率
  { wch: 80 }, // 职业方向
  { wch: 50 }, // 职业领域
  { wch: 50 }, // 技能要求
  { wch: 60 }  // 优势院校
];

// 将工作表添加到工作簿
XLSX.utils.book_append_sheet(workbook, worksheet, '专业数据');

// 创建说明工作表
const instructionData = [
  { '字段名': '专业代码', '说明': '6位专业代码,选填,如有则需唯一', '示例': '080901' },
  { '字段名': '专业名称', '说明': '专业名称,必填', '示例': '计算机科学与技术' },
  { '字段名': '学科', '说明': '所属学科门类', '示例': '工学、理学、文学、医学等' },
  { '字段名': '门类', '说明': '专业门类,必填', '示例': '计算机类、电子信息类等' },
  { '字段名': '子类', '说明': '专业子类,选填', '示例': '' },
  { '字段名': '匹配学科', '说明': '高中选考要求,用逗号分隔', '示例': '物理,数学' },
  { '字段名': '学位', '说明': '学位名称', '示例': '工学学士' },
  { '字段名': '学位类型', '说明': '学位类型', '示例': '工学' },
  { '字段名': '学制', '说明': '学习年限,数字', '示例': '4' },
  { '字段名': '培养对象', '说明': '培养目标描述', '示例': '培养具有...的专门人才' },
  { '字段名': '主修课程', '说明': '主要课程,用逗号分隔', '示例': '程序设计,数据结构,操作系统' },
  { '字段名': '是否热门', '说明': '"是"或"否"', '示例': '是' },
  { '字段名': '标签', '说明': '专业特点标签,用逗号分隔', '示例': 'IT行业,高薪,技术密集' },
  { '字段名': '平均薪资', '说明': '毕业生平均月薪,数字(元)', '示例': '12000' },
  { '字段名': '就业率', '说明': '就业率百分比,数字', '示例': '95.5' },
  { '字段名': '职业方向', '说明': '职业发展方向描述', '示例': '可从事软件开发工程师...' },
  { '字段名': '职业领域', '说明': '就业领域,用逗号分隔', '示例': '软件开发,人工智能,大数据' },
  { '字段名': '技能要求', '说明': '所需技能,用逗号分隔', '示例': '编程能力,算法设计,系统分析' },
  { '字段名': '优势院校', '说明': '该专业优势院校,用逗号分隔', '示例': '清华大学,北京大学,浙江大学' }
];

const instructionSheet = XLSX.utils.json_to_sheet(instructionData);
instructionSheet['!cols'] = [
  { wch: 15 },
  { wch: 50 },
  { wch: 50 }
];
XLSX.utils.book_append_sheet(workbook, instructionSheet, '字段说明');

// 保存文件
const filePath = path.join(__dirname, '../data/sample_majors.xlsx');
XLSX.writeFile(workbook, filePath);

console.log(`✅ 专业示例 Excel 文件已创建: ${filePath}`);
console.log(`包含 ${sampleData.length} 条示例专业数据`);
console.log(`\n📝 字段说明:`);
console.log(`- 必填字段: 专业名称、门类`);
console.log(`- 选填字段: 专业代码（如填写则需唯一）`);
console.log(`- 数组字段(用逗号分隔): 匹配学科、主修课程、标签、职业领域、技能要求、优势院校`);
console.log(`- 布尔字段: 是否热门 (填"是"或"否")`);
console.log(`- 数字字段: 学制、平均薪资、就业率`);
console.log(`\n💡 使用方法:`);
console.log(`npm run import-majors ./data/sample_majors.xlsx`);
